<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
</head>

<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
<script>
var ballX = 75; //início da bola, X
var ballY = 75; // início da bola, Y

var speedX = 10;
var speedY = 10;
var canvas;
var canvasContext;

var paddleY = 250;
var paddle2Y = 250;

const PADDLE_HEIGHT = 100;
const PADDLE_THICKNESS = 10;

function updateMousePos(evt) {
    var rect = canvas.getBoundingClientRect();
    var root = document.documentElement;
    var mouseY = evt.clientY - rect.top - root.scrollTop;
    paddleY = mouseY - PADDLE_HEIGHT/2;
}

window.onload = function() {
    var fps = 30;
    // salvar o canvas e o contexto 2d
    canvas = document.getElementById('gameCanvas');
    canvasContext = canvas.getContext('2d');
    setInterval(update, 1000/fps);
    canvas.addEventListener('mousemove', updateMousePos) 
}

function update() {
    move();
    draw();
}

function ballReset () {
    ballX = canvas.width/2;
    ballY = canvas.height/2;
}

function move() {
    if (ballX >= canvas.width) { // parede direita
        speedX *= -1;
    }
    if (ballX <= 0) { // parede esquerda
        if (ballY > paddleY && ballY < paddleY+PADDLE_HEIGHT) {
            speedX *= -1;
        }
        else {
            ballReset();
        }
    }
    if (ballY >= canvas.height || ballY <= 0) {
        speedY *= -1;
    }
    ballX += speedX; //mover bola em X
    ballY += speedY;
}

function colorRect (topLeftX, topLeftY, boxWidth, boxHeight, fillColor) {
    // função dos retangulos
    canvasContext.fillStyle = fillColor;
    canvasContext.fillRect(topLeftX,topLeftY,boxWidth,boxHeight);
}

function colorCircle (centerX, centerY, radius, fillColor) {
    // desenhar bola
    canvasContext.fillStyle = fillColor; //cor
    canvasContext.beginPath(); // novo shape
    canvasContext.arc(centerX, centerY, radius, 0, Math.PI*2, true); // descrevendo o círculo
    canvasContext.fill(); //pintar
}

function draw() {
    // pintar o canvas
    colorRect(0, 0, canvas.width, canvas.height, 'black');
    // desenhar raquete usuário
    colorRect(10, paddleY, PADDLE_THICKNESS, PADDLE_HEIGHT, 'white');
    // desenhar raquete computador
    colorRect(canvas.width-2*PADDLE_THICKNESS, paddle2Y, PADDLE_THICKNESS, PADDLE_HEIGHT, 'blue');
    colorCircle(ballX, ballY, 10, 'white');
}

</script>


</body>